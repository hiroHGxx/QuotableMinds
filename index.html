<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quotable Minds - ã‚ãªãŸã‚’å°ãå‰äººã®è¨€è‘‰</title>
    <meta name="description" content="ã‚ãªãŸã®ä¾¡å€¤è¦³ã«åˆã†æ­´å²ä¸Šã®å‰äººã¨ãã®åè¨€ã‚’è¦‹ã¤ã‘ã‚‹è¨ºæ–­ã‚³ãƒ³ãƒ†ãƒ³ãƒ„">
    
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;600;700&family=Inter:wght@300;400;500;600&display=swap" rel="stylesheet">
    
    <!-- Custom styles -->
    <style>
        .font-serif { font-family: 'Playfair Display', serif; }
        .font-sans { font-family: 'Inter', sans-serif; }
        
        /* ã‚¹ãƒ ãƒ¼ã‚ºãªã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ */
        .screen { 
            transition: opacity 0.3s ease-in-out; 
        }
        
        /* é¸æŠè‚¢ãƒœã‚¿ãƒ³ã®ã‚«ã‚¹ã‚¿ãƒ ã‚¹ã‚¿ã‚¤ãƒ« */
        .option-button {
            background-color: #ffffff;
            border: 2px solid #e5e7eb;
            border-radius: 12px;
            padding: 16px;
            text-align: left;
            width: 100%;
            transition: all 0.2s ease-in-out;
            cursor: pointer;
        }
        
        .option-button:hover {
            border-color: #166534;
            background-color: #f0fdf4;
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }
        
        .option-button.selected {
            border-color: #166534;
            background-color: #f0fdf4;
            box-shadow: 0 0 0 3px rgba(22, 101, 52, 0.1);
        }
        
        /* ã‚«ãƒ¼ãƒ‰ã®ã‚·ãƒ£ãƒ‰ã‚¦ã‚¹ã‚¿ã‚¤ãƒ« */
        .card-shadow {
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
        }
        
        /* ãƒœã‚¿ãƒ³ã®ãƒã‚¤ã‚¯ãƒ­ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ã‚·ãƒ§ãƒ³ */
        .btn-primary {
            background-color: #166534;
            transition: all 0.2s ease-in-out;
        }
        
        .btn-primary:hover {
            background-color: #15803d;
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(22, 101, 52, 0.3);
        }
        
        /* ãƒ—ãƒ­ã‚°ãƒ¬ã‚¹ãƒãƒ¼ã®ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ */
        .progress-bar {
            background: linear-gradient(90deg, #166534, #15803d);
            border-radius: 8px;
            transition: width 0.5s ease-in-out;
        }
    </style>
</head>
<body class="bg-stone-50 font-sans">
    <div class="min-h-screen">
        
        <!-- ã‚¹ã‚¿ãƒ¼ãƒˆç”»é¢ -->
        <div id="start-screen" class="screen">
            <div class="min-h-screen flex items-center justify-center p-4">
                <div class="text-center max-w-2xl mx-auto">
                    <h1 class="font-serif text-4xl md:text-6xl font-bold text-gray-800 mb-6">
                        Quotable Minds
                    </h1>
                    <p class="font-serif text-xl md:text-2xl text-gray-600 mb-8">
                        ã‚ãªãŸã‚’å°ãå‰äººã®è¨€è‘‰
                    </p>
                    <p class="text-gray-600 mb-12 text-lg leading-relaxed">
                        5ã¤ã®è³ªå•ã«ç­”ãˆã¦ã€ã‚ãªãŸã®ä¾¡å€¤è¦³ã«è¿‘ã„<br>
                        æ­´å²ä¸Šã®å‰äººã¨ãã®åè¨€ã«å‡ºä¼šã„ã¾ã—ã‚‡ã†
                    </p>
                    <button id="start-btn" class="btn-primary text-white px-8 py-4 rounded-full text-lg font-medium">
                        è¨ºæ–­ã‚’å§‹ã‚ã‚‹
                    </button>
                </div>
            </div>
        </div>

        <!-- è¨ºæ–­ç”»é¢ -->
        <div id="diagnosis-screen" class="screen hidden">
            <div class="min-h-screen flex items-center justify-center p-4">
                <div class="w-full max-w-2xl mx-auto">
                    
                    <!-- ãƒ—ãƒ­ã‚°ãƒ¬ã‚¹ãƒãƒ¼ -->
                    <div class="mb-8">
                        <div class="flex justify-between text-sm text-gray-600 mb-2">
                            <span>è³ªå• <span id="current-question">1</span> / 5</span>
                            <span><span id="progress-percent">20</span>%</span>
                        </div>
                        <div class="w-full bg-gray-200 rounded-full h-2">
                            <div id="progress-bar" class="progress-bar h-2 rounded-full" style="width: 20%"></div>
                        </div>
                    </div>

                    <!-- è³ªå•ã‚«ãƒ¼ãƒ‰ -->
                    <div class="bg-white rounded-2xl card-shadow p-8 mb-6">
                        <h2 id="question-text" class="font-serif text-2xl md:text-3xl text-gray-800 mb-8 leading-relaxed">
                            <!-- è³ªå•ãŒã“ã“ã«è¡¨ç¤ºã•ã‚Œã¾ã™ -->
                        </h2>
                        
                        <!-- é¸æŠè‚¢ -->
                        <div id="options-container" class="space-y-4">
                            <!-- é¸æŠè‚¢ãŒã“ã“ã«å‹•çš„ã«ç”Ÿæˆã•ã‚Œã¾ã™ -->
                        </div>
                    </div>

                    <!-- ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ -->
                    <div class="flex justify-between">
                        <button id="prev-btn" class="text-gray-500 hover:text-gray-700 px-4 py-2 rounded-lg transition-colors duration-200 disabled:opacity-50" disabled>
                            â† å‰ã®è³ªå•
                        </button>
                        <button id="next-btn" class="btn-primary text-white px-6 py-2 rounded-lg disabled:opacity-50" disabled>
                            æ¬¡ã®è³ªå• â†’
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- çµæœç”»é¢ -->
        <div id="result-screen" class="screen hidden">
            <div class="min-h-screen flex items-center justify-center p-4">
                <div class="w-full max-w-2xl mx-auto text-center">
                    
                    <h2 class="font-serif text-3xl md:text-4xl text-gray-800 mb-8">
                        è¨ºæ–­çµæœ
                    </h2>

                    <!-- çµæœã‚«ãƒ¼ãƒ‰ -->
                    <div class="bg-white rounded-2xl card-shadow p-8 mb-8">
                        <div class="mb-6">
                            <img id="result-image" src="" alt="" class="w-32 h-32 mx-auto rounded-full mb-4">
                        </div>
                        
                        <h3 class="font-serif text-2xl md:text-3xl text-gray-800 mb-2">
                            ã‚ãªãŸã¯
                        </h3>
                        <h4 id="result-name" class="font-serif text-3xl md:text-4xl font-bold text-green-800 mb-4">
                            <!-- å‰äººå -->
                        </h4>
                        <p id="result-type" class="text-xl text-gray-600 mb-6">
                            <!-- ã‚¿ã‚¤ãƒ— -->
                        </p>
                        
                        <blockquote class="font-serif text-xl md:text-2xl text-gray-700 italic mb-6 leading-relaxed">
                            "<span id="result-quote"><!-- åè¨€ --></span>"
                        </blockquote>
                        
                        <p id="result-description" class="text-gray-600 leading-relaxed">
                            <!-- èª¬æ˜æ–‡ -->
                        </p>
                        
                        <!-- LLMä½¿ç”¨çŠ¶æ³è¡¨ç¤º -->
                        <div id="llm-status" class="mt-4 p-3 rounded-lg text-sm hidden">
                            <div class="flex items-center">
                                <span id="llm-status-icon" class="mr-2"></span>
                                <span id="llm-status-text"></span>
                            </div>
                        </div>
                    </div>

                    <!-- ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ãƒœã‚¿ãƒ³ -->
                    <div class="flex flex-col sm:flex-row gap-4 justify-center">
                        <button id="retry-btn" class="bg-gray-200 hover:bg-gray-300 text-gray-800 px-6 py-3 rounded-lg transition-colors duration-200">
                            ã‚‚ã†ä¸€åº¦è¨ºæ–­ã™ã‚‹
                        </button>
                        <button id="share-btn" class="bg-blue-500 hover:bg-blue-600 text-white px-6 py-3 rounded-lg transition-all duration-200 hover:transform hover:scale-105">
                            çµæœã‚’ã‚·ã‚§ã‚¢
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // è¨ºæ–­ãƒ‡ãƒ¼ã‚¿
        const diagnosisData = {
            "personalities": [
                {
                    "id": "jobs",
                    "name": "ã‚¹ãƒ†ã‚£ãƒ¼ãƒ–ãƒ»ã‚¸ãƒ§ãƒ–ã‚º",
                    "type": "é©æ–°å®¶",
                    "quote": "ãƒãƒ³ã‚°ãƒªãƒ¼ã§ã‚ã‚Œã€‚æ„šã‹è€…ã§ã‚ã‚Œã€‚",
                    "description": "æ—¢å­˜ã®å¸¸è­˜ã‚’è¦†ã—ã€ä¸–ç•Œã‚’å¤‰ãˆã‚‹é©æ–°çš„ãªã‚¢ã‚¤ãƒ‡ã‚¢ã‚’è¿½æ±‚ã™ã‚‹äººã€‚å®Œç’§ä¸»ç¾©ã§ã€ç¾ã—ã•ã¨æ©Ÿèƒ½æ€§ã‚’å…¼ã­å‚™ãˆãŸå‰µé€ ã‚’ç›®æŒ‡ã—ã¾ã™ã€‚",
                    "imageUrl": "https://placehold.jp/300x300.png?text=Jobs"
                },
                {
                    "id": "chanel",
                    "name": "ã‚³ã‚³ãƒ»ã‚·ãƒ£ãƒãƒ«",
                    "type": "è‡ªç”±ãªé­‚",
                    "quote": "ç§ã¯æµè¡Œã‚’ä½œã‚‹ã®ã§ã¯ãªã„ã€‚ç§ãŒæµè¡Œãªã®ã ã€‚",
                    "description": "æ—¢å­˜ã®æ ã«ã¨ã‚‰ã‚ã‚Œãšã€è‡ªåˆ†ã‚‰ã—ã•ã‚’å¤§åˆ‡ã«ã™ã‚‹äººã€‚ã‚¨ãƒ¬ã‚¬ãƒ³ã‚¹ã¨ç‹¬ç«‹å¿ƒã‚’æŒã¡ã€ä»–äººã®æœŸå¾…ã‚ˆã‚Šè‡ªåˆ†ã®ä¿¡å¿µã‚’å„ªå…ˆã—ã¾ã™ã€‚",
                    "imageUrl": "https://placehold.jp/300x300.png?text=Chanel"
                },
                {
                    "id": "einstein",
                    "name": "ã‚¢ãƒ«ãƒ™ãƒ«ãƒˆãƒ»ã‚¢ã‚¤ãƒ³ã‚·ãƒ¥ã‚¿ã‚¤ãƒ³",
                    "type": "æ¢æ±‚è€…",
                    "quote": "æƒ³åƒåŠ›ã¯çŸ¥è­˜ã‚ˆã‚Šã‚‚é‡è¦ã§ã‚ã‚‹ã€‚",
                    "description": "çŸ¥è­˜æ¬²ãŒæ—ºç››ã§ã€ç‰©äº‹ã®æœ¬è³ªã‚’ç†è§£ã—ã‚ˆã†ã¨ã™ã‚‹äººã€‚è«–ç†çš„æ€è€ƒã¨å‰µé€ æ€§ã‚’å…¼ã­å‚™ãˆã€å¸¸ã«æ–°ã—ã„ç™ºè¦‹ã‚’æ±‚ã‚ã¦ã„ã¾ã™ã€‚",
                    "imageUrl": "https://placehold.jp/300x300.png?text=Einstein"
                },
                {
                    "id": "disney",
                    "name": "ã‚¦ã‚©ãƒ«ãƒˆãƒ»ãƒ‡ã‚£ã‚ºãƒ‹ãƒ¼",
                    "type": "å¤¢æƒ³å®¶",
                    "quote": "å¤¢è¦‹ã‚‹ã“ã¨ãŒã§ãã‚Œã°ã€ãã‚Œã¯å®Ÿç¾ã§ãã‚‹ã€‚",
                    "description": "å¤§ããªå¤¢ã‚’æŠ±ãã€äººã€…ã«å¸Œæœ›ã¨å–œã³ã‚’ä¸ãˆã‚‹äººã€‚æ¥½è¦³çš„ã§ã€å›°é›£ãªçŠ¶æ³ã§ã‚‚å‰å‘ãã«æœªæ¥ã‚’æãç¶šã‘ã¾ã™ã€‚",
                    "imageUrl": "https://placehold.jp/300x300.png?text=Disney"
                },
                {
                    "id": "mandela",
                    "name": "ãƒãƒ«ã‚½ãƒ³ãƒ»ãƒãƒ³ãƒ‡ãƒ©",
                    "type": "å¹³å’Œã®ä½¿è€…",
                    "quote": "æ•™è‚²ã¯ã€ä¸–ç•Œã‚’å¤‰ãˆã‚‹ãŸã‚ã«ä½¿ãˆã‚‹æœ€ã‚‚å¼·åŠ›ãªæ­¦å™¨ã§ã‚ã‚‹ã€‚",
                    "description": "ä»–è€…ã¨ã®èª¿å’Œã‚’é‡è¦–ã—ã€å¹³å’Œã¨ç†è§£ã‚’ç¯‰ãäººã€‚å›°é›£ã«ç›´é¢ã—ã¦ã‚‚è«¦ã‚ãšã€ã™ã¹ã¦ã®äººã®å¹¸ç¦ã‚’é¡˜ã†æ¸©ã‹ã„å¿ƒã®æŒã¡ä¸»ã§ã™ã€‚",
                    "imageUrl": "https://placehold.jp/300x300.png?text=Mandela"
                },
                {
                    "id": "curie",
                    "name": "ãƒãƒªãƒ¼ãƒ»ã‚­ãƒ¥ãƒªãƒ¼",
                    "type": "æŒ‘æˆ¦è€…",
                    "quote": "äººç”Ÿã«ãŠã„ã¦æã‚Œã‚‹ã¹ãã‚‚ã®ã¯ä½•ã‚‚ãªã„ã€‚ç†è§£ã™ã¹ãã“ã¨ãŒã‚ã‚‹ã ã‘ã ã€‚",
                    "description": "å›°é›£ã«ç«‹ã¡å‘ã‹ã„ã€å‰ä¾‹ã®ãªã„é“ã‚’åˆ‡ã‚Šé–‹ãäººã€‚å¼·ã„æ„å¿—ã¨æƒ…ç†±ã‚’æŒã¡ã€æ€§åˆ¥ã‚„ç¤¾ä¼šçš„åˆ¶ç´„ã‚’è¶…ãˆã¦ç›®æ¨™ã‚’é”æˆã—ã¾ã™ã€‚",
                    "imageUrl": "https://placehold.jp/300x300.png?text=Curie"
                }
            ],
            "questions": [
                {
                    "id": 1,
                    "question": "æ–°ã—ã„ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’å§‹ã‚ã‚‹æ™‚ã€ã‚ãªãŸãŒæœ€ã‚‚é‡è¦–ã™ã‚‹ã®ã¯ï¼Ÿ",
                    "options": [
                        {
                            "text": "èª°ã‚‚æ€ã„ã¤ã‹ãªã‹ã£ãŸé©æ–°çš„ãªã‚¢ã‚¤ãƒ‡ã‚¢",
                            "points": { "jobs": 2, "einstein": 1 }
                        },
                        {
                            "text": "è‡ªåˆ†ã‚‰ã—ã•ã‚’è¡¨ç¾ã§ãã‚‹ã“ã¨",
                            "points": { "chanel": 2, "disney": 1 }
                        },
                        {
                            "text": "å¤šãã®äººã«å–œã‚“ã§ã‚‚ã‚‰ãˆã‚‹ã“ã¨",
                            "points": { "disney": 2, "mandela": 1 }
                        },
                        {
                            "text": "å›°é›£ã«æŒ‘æˆ¦ã—æˆé•·ã§ãã‚‹ã“ã¨",
                            "points": { "curie": 2, "mandela": 1 }
                        }
                    ]
                },
                {
                    "id": 2,
                    "question": "å›°é›£ãªå•é¡Œã«ç›´é¢ã—ãŸæ™‚ã€ã‚ãªãŸã¯ã©ã†å¯¾å‡¦ã—ã¾ã™ã‹ï¼Ÿ",
                    "options": [
                        {
                            "text": "å¾¹åº•çš„ã«åˆ†æã—ã€æ ¹æœ¬åŸå› ã‚’ç†è§£ã™ã‚‹",
                            "points": { "einstein": 2, "curie": 1 }
                        },
                        {
                            "text": "å¾“æ¥ã®æ–¹æ³•ã‚’ç–‘ã„ã€å…¨ãæ–°ã—ã„ã‚¢ãƒ—ãƒ­ãƒ¼ãƒã‚’è©¦ã™",
                            "points": { "jobs": 2, "chanel": 1 }
                        },
                        {
                            "text": "å‘¨ã‚Šã®äººã¨å”åŠ›ã—ã€ã¿ã‚“ãªã§è§£æ±ºç­–ã‚’è¦‹ã¤ã‘ã‚‹",
                            "points": { "mandela": 2, "disney": 1 }
                        },
                        {
                            "text": "è«¦ã‚ãšã«ä½•åº¦ã§ã‚‚æŒ‘æˆ¦ã—ç¶šã‘ã‚‹",
                            "points": { "curie": 2, "disney": 1 }
                        }
                    ]
                },
                {
                    "id": 3,
                    "question": "ã‚ãªãŸã«ã¨ã£ã¦ã€ŒæˆåŠŸã€ã¨ã¯ä½•ã§ã™ã‹ï¼Ÿ",
                    "options": [
                        {
                            "text": "ä¸–ç•Œã‚’å¤‰ãˆã‚‹ã‚ˆã†ãªã‚¤ãƒ³ãƒ‘ã‚¯ãƒˆã‚’ä¸ãˆã‚‹ã“ã¨",
                            "points": { "jobs": 2, "einstein": 1 }
                        },
                        {
                            "text": "è‡ªåˆ†ã®ä¾¡å€¤è¦³ã‚’è²«ãé€šã›ã‚‹ã“ã¨",
                            "points": { "chanel": 2, "curie": 1 }
                        },
                        {
                            "text": "å¤šãã®äººã‚’å¹¸ã›ã«ã§ãã‚‹ã“ã¨",
                            "points": { "disney": 2, "mandela": 1 }
                        },
                        {
                            "text": "æœªçŸ¥ã®é ˜åŸŸã‚’é–‹æ‹“ã™ã‚‹ã“ã¨",
                            "points": { "curie": 2, "einstein": 1 }
                        }
                    ]
                },
                {
                    "id": 4,
                    "question": "ç†æƒ³çš„ãªä¸€æ—¥ã®éã”ã—æ–¹ã¯ï¼Ÿ",
                    "options": [
                        {
                            "text": "é›†ä¸­ã—ã¦å‰µé€ çš„ãªä½œæ¥­ã«æ²¡é ­ã™ã‚‹",
                            "points": { "jobs": 1, "einstein": 2 }
                        },
                        {
                            "text": "è‡ªåˆ†ã®ãƒšãƒ¼ã‚¹ã§å¥½ããªã“ã¨ã‚’æ¥½ã—ã‚€",
                            "points": { "chanel": 2, "disney": 1 }
                        },
                        {
                            "text": "å¤§åˆ‡ãªäººãŸã¡ã¨æ™‚é–“ã‚’å…±æœ‰ã™ã‚‹",
                            "points": { "mandela": 2, "disney": 1 }
                        },
                        {
                            "text": "æ–°ã—ã„ã“ã¨ã‚’å­¦ã³ã€æŒ‘æˆ¦ã™ã‚‹",
                            "points": { "curie": 2, "einstein": 1 }
                        }
                    ]
                },
                {
                    "id": 5,
                    "question": "äººç”Ÿã§æœ€ã‚‚å¤§åˆ‡ã«ã—ãŸã„ä¾¡å€¤è¦³ã¯ï¼Ÿ",
                    "options": [
                        {
                            "text": "å®Œç’§æ€§ã¨ç¾ã—ã•",
                            "points": { "jobs": 2, "chanel": 1 }
                        },
                        {
                            "text": "è‡ªç”±ã¨ç‹¬ç«‹",
                            "points": { "chanel": 2, "curie": 1 }
                        },
                        {
                            "text": "å¸Œæœ›ã¨æ¥½è¦³",
                            "points": { "disney": 2, "mandela": 1 }
                        },
                        {
                            "text": "çœŸå®Ÿã¨çŸ¥è­˜",
                            "points": { "einstein": 2, "curie": 1 }
                        }
                    ]
                }
            ]
        };
        
        // ç¾åœ¨ã®çŠ¶æ…‹
        let currentQuestion = 0;
        let answers = [];
        let currentScreen = 'start';
        
        // DOMè¦ç´ ã®å–å¾—
        const screens = {
            start: document.getElementById('start-screen'),
            diagnosis: document.getElementById('diagnosis-screen'),
            result: document.getElementById('result-screen')
        };
        
        // ç”»é¢åˆ‡ã‚Šæ›¿ãˆæ©Ÿèƒ½
        function showScreen(screenName) {
            console.log(`Switching to ${screenName} screen`);
            
            // å…¨ã¦ã®ç”»é¢ã‚’éè¡¨ç¤º
            Object.values(screens).forEach(screen => {
                screen.classList.add('hidden');
            });
            
            // æŒ‡å®šã•ã‚ŒãŸç”»é¢ã‚’è¡¨ç¤º
            if (screens[screenName]) {
                screens[screenName].classList.remove('hidden');
                currentScreen = screenName;
                
                // ç”»é¢åˆ‡ã‚Šæ›¿ãˆæ™‚ã®ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³
                screens[screenName].style.opacity = '0';
                setTimeout(() => {
                    screens[screenName].style.opacity = '1';
                }, 50);
            } else {
                console.error(`Screen ${screenName} not found`);
            }
        }
        
        // è¨ºæ–­é–‹å§‹
        function startDiagnosis() {
            console.log('Starting diagnosis...');
            currentQuestion = 0;
            answers = [];
            showScreen('diagnosis');
            loadQuestion();
        }
        
        // è³ªå•ã‚’èª­ã¿è¾¼ã¿
        function loadQuestion() {
            if (currentQuestion >= diagnosisData.questions.length) {
                calculateResult();
                return;
            }
            
            const question = diagnosisData.questions[currentQuestion];
            
            // è³ªå•ãƒ†ã‚­ã‚¹ãƒˆã‚’æ›´æ–°
            document.getElementById('question-text').textContent = question.question;
            
            // ãƒ—ãƒ­ã‚°ãƒ¬ã‚¹ãƒãƒ¼ã‚’æ›´æ–°
            const progress = ((currentQuestion + 1) / diagnosisData.questions.length) * 100;
            document.getElementById('current-question').textContent = currentQuestion + 1;
            document.getElementById('progress-percent').textContent = Math.round(progress);
            document.getElementById('progress-bar').style.width = progress + '%';
            
            // é¸æŠè‚¢ã‚’ç”Ÿæˆ
            const optionsContainer = document.getElementById('options-container');
            optionsContainer.innerHTML = '';
            
            question.options.forEach((option, index) => {
                const button = document.createElement('button');
                button.className = 'option-button';
                button.textContent = option.text;
                button.addEventListener('click', () => selectOption(index));
                optionsContainer.appendChild(button);
            });
            
            // ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ãƒœã‚¿ãƒ³ã®çŠ¶æ…‹ã‚’æ›´æ–°
            updateNavigationButtons();
        }
        
        // é¸æŠè‚¢ã‚’é¸æŠ
        function selectOption(optionIndex) {
            const question = diagnosisData.questions[currentQuestion];
            const selectedOption = question.options[optionIndex];
            
            // å›ç­”ã‚’ä¿å­˜
            answers[currentQuestion] = {
                questionId: question.id,
                optionIndex: optionIndex,
                points: selectedOption.points
            };
            
            // é¸æŠã•ã‚ŒãŸé¸æŠè‚¢ã‚’ãƒã‚¤ãƒ©ã‚¤ãƒˆ
            const options = document.querySelectorAll('#options-container button');
            options.forEach((btn, index) => {
                if (index === optionIndex) {
                    btn.classList.add('selected');
                } else {
                    btn.classList.remove('selected');
                }
            });
            
            // æ¬¡ã®è³ªå•ãƒœã‚¿ãƒ³ã‚’æœ‰åŠ¹åŒ–
            document.getElementById('next-btn').disabled = false;
            
            console.log(`Question ${currentQuestion + 1} answered:`, selectedOption);
        }
        
        // æ¬¡ã®è³ªå•ã¸
        function nextQuestion() {
            if (answers[currentQuestion]) {
                currentQuestion++;
                loadQuestion();
            }
        }
        
        // å‰ã®è³ªå•ã¸
        function prevQuestion() {
            if (currentQuestion > 0) {
                currentQuestion--;
                loadQuestion();
            }
        }
        
        // ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ãƒœã‚¿ãƒ³ã®çŠ¶æ…‹æ›´æ–°
        function updateNavigationButtons() {
            const prevBtn = document.getElementById('prev-btn');
            const nextBtn = document.getElementById('next-btn');
            
            prevBtn.disabled = currentQuestion === 0;
            nextBtn.disabled = !answers[currentQuestion];
            
            // æœ€å¾Œã®è³ªå•ã®å ´åˆã€ãƒœã‚¿ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã‚’å¤‰æ›´
            if (currentQuestion === diagnosisData.questions.length - 1) {
                nextBtn.textContent = 'çµæœã‚’è¦‹ã‚‹';
            } else {
                nextBtn.textContent = 'æ¬¡ã®è³ªå• â†’';
            }
        }
        
        // è¨ºæ–­çµæœã‚’è¨ˆç®—
        function calculateResult() {
            console.log('Calculating result...');
            
            // å„å‰äººã®ãƒã‚¤ãƒ³ãƒˆã‚’é›†è¨ˆ
            const scores = {};
            diagnosisData.personalities.forEach(p => {
                scores[p.id] = 0;
            });
            
            answers.forEach(answer => {
                Object.entries(answer.points).forEach(([personalityId, points]) => {
                    scores[personalityId] += points;
                });
            });
            
            console.log('Scores:', scores);
            
            // æœ€é«˜å¾—ç‚¹ã®å‰äººã‚’é¸æŠ
            let maxScore = 0;
            let resultPersonality = null;
            
            Object.entries(scores).forEach(([personalityId, score]) => {
                if (score > maxScore) {
                    maxScore = score;
                    resultPersonality = diagnosisData.personalities.find(p => p.id === personalityId);
                }
            });
            
            console.log('Result personality:', resultPersonality);
            
            showResult(resultPersonality);
        }
        
        // çµæœã‚’è¡¨ç¤º
        function showResult(personality) {
            showScreen('result');
            
            document.getElementById('result-name').textContent = personality.name;
            document.getElementById('result-type').textContent = `ã‚¿ã‚¤ãƒ—ï¼š${personality.type}`;
            document.getElementById('result-quote').textContent = personality.quote;
            document.getElementById('result-description').textContent = personality.description;
            document.getElementById('result-image').src = personality.imageUrl;
            document.getElementById('result-image').alt = personality.name;
            
            // ãƒ‘ãƒ¼ã‚½ãƒŠãƒ©ã‚¤ã‚ºè§£èª¬ã‚’APIçµŒç”±ã§å–å¾—
            fetchPersonalizedAnalysis(personality);
        }
        
        // ãƒ‘ãƒ¼ã‚½ãƒŠãƒ©ã‚¤ã‚ºè§£èª¬ã‚’APIã‹ã‚‰å–å¾—
        async function fetchPersonalizedAnalysis(personality) {
            try {
                const response = await fetch('./api/personalized-analysis', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        personality: personality,
                        answers: answers
                    })
                });
                
                if (response.ok) {
                    const data = await response.json();
                    
                    // ãƒ‘ãƒ¼ã‚½ãƒŠãƒ©ã‚¤ã‚ºè§£èª¬ã‚’è¡¨ç¤º
                    if (data.analysis) {
                        document.getElementById('result-description').textContent = data.analysis;
                    }
                    
                    // LLMä½¿ç”¨çŠ¶æ³ã‚’è¡¨ç¤º
                    showLLMStatus(data.llmStatus, data.llmUsed, data.errorMessage);
                } else {
                    console.error('API Error:', response.status);
                    showLLMStatus('api_error', false, 'APIæ¥ç¶šã‚¨ãƒ©ãƒ¼');
                }
            } catch (error) {
                console.error('Fetch Error:', error);
                showLLMStatus('fetch_error', false, 'ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚¨ãƒ©ãƒ¼');
            }
        }
        
        // LLMä½¿ç”¨çŠ¶æ³ã‚’è¡¨ç¤º
        function showLLMStatus(status, llmUsed, errorMessage) {
            const statusDiv = document.getElementById('llm-status');
            const iconSpan = document.getElementById('llm-status-icon');
            const textSpan = document.getElementById('llm-status-text');
            
            let bgColor, icon, text;
            
            switch(status) {
                case 'gemini':
                    bgColor = 'bg-green-100 border border-green-300';
                    icon = 'ğŸ¤–';
                    text = 'AI (Gemini) ãŒè§£èª¬ã‚’ç”Ÿæˆã—ã¾ã—ãŸ';
                    break;
                case 'mock_fallback':
                    bgColor = 'bg-yellow-100 border border-yellow-300';
                    icon = 'âš ï¸';
                    text = 'AIãŒåˆ©ç”¨ã§ããªã„ãŸã‚ã€æ¨™æº–è§£èª¬ã‚’è¡¨ç¤ºã—ã¦ã„ã¾ã™';
                    break;
                case 'api_error':
                case 'fetch_error':
                    bgColor = 'bg-red-100 border border-red-300';
                    icon = 'âŒ';
                    text = 'APIæ¥ç¶šã‚¨ãƒ©ãƒ¼ã®ãŸã‚ã€æ¨™æº–è§£èª¬ã‚’è¡¨ç¤ºã—ã¦ã„ã¾ã™';
                    break;
                default:
                    bgColor = 'bg-gray-100 border border-gray-300';
                    icon = 'ğŸ“';
                    text = 'æ¨™æº–è§£èª¬ã‚’è¡¨ç¤ºã—ã¦ã„ã¾ã™';
            }
            
            statusDiv.className = `mt-4 p-3 rounded-lg text-sm ${bgColor}`;
            iconSpan.textContent = icon;
            textSpan.textContent = text;
            statusDiv.classList.remove('hidden');
            
            // é–‹ç™ºç’°å¢ƒã§ã®ãƒ‡ãƒãƒƒã‚°æƒ…å ±
            if (errorMessage && window.location.hostname === 'localhost') {
                textSpan.textContent += ` (${errorMessage})`;
            }
        }
        
        // ãƒªãƒˆãƒ©ã‚¤æ©Ÿèƒ½
        function retryDiagnosis() {
            console.log('Retrying diagnosis...');
            currentQuestion = 0;
            answers = [];
            showScreen('start');
        }
        
        // SNSã‚·ã‚§ã‚¢æ©Ÿèƒ½
        function shareResult() {
            const resultName = document.getElementById('result-name').textContent;
            const resultQuote = document.getElementById('result-quote').textContent;
            const url = window.location.href;
            
            const shareText = `ç§ã¯${resultName}ã‚¿ã‚¤ãƒ—ã§ã—ãŸï¼\n"${resultQuote}"\n\n#QuotableMinds ã‚ãªãŸã‚’å°ãå‰äººã®è¨€è‘‰\n${url}`;
            
            // Twitter/X ã®ã‚·ã‚§ã‚¢URL
            const twitterUrl = `https://twitter.com/intent/tweet?text=${encodeURIComponent(shareText)}`;
            
            console.log('Sharing result:', shareText);
            
            // æ–°ã—ã„ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã§Twitterã‚’é–‹ã
            window.open(twitterUrl, '_blank', 'width=550,height=420');
        }
        
        // ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼ã®è¨­å®š
        document.getElementById('start-btn').addEventListener('click', startDiagnosis);
        document.getElementById('retry-btn').addEventListener('click', retryDiagnosis);
        document.getElementById('next-btn').addEventListener('click', nextQuestion);
        document.getElementById('prev-btn').addEventListener('click', prevQuestion);
        document.getElementById('share-btn').addEventListener('click', shareResult);
        
        // åˆæœŸåŒ–
        document.addEventListener('DOMContentLoaded', function() {
            console.log('Quotable Minds - Screen switching functionality loaded');
            showScreen('start'); // åˆæœŸç”»é¢ã‚’è¡¨ç¤º
        });
    </script>
</body>
</html>